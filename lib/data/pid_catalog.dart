import '../models/obd2_pid.dart';

/// Static catalog of OBD2 Mode 01 PIDs with decoding formulas.
class PidCatalog {
  PidCatalog._();

  static final List<Obd2Pid> all = [
    Obd2Pid(
      pid: '0104',
      nameEs: 'Carga del motor',
      nameEn: 'Engine load',
      unit: '%',
      category: PidCategory.engine,
      dataBytes: 1,
      decode: (b) => b[0] * 100 / 255,
      normalMax: 80,
      warningMax: 95,
    ),
    Obd2Pid(
      pid: '0105',
      nameEs: 'Temp. refrigerante',
      nameEn: 'Coolant temp',
      unit: '°C',
      category: PidCategory.engine,
      dataBytes: 1,
      decode: (b) => b[0] - 40,
      normalMax: 105,
      warningMax: 115,
    ),
    Obd2Pid(
      pid: '0106',
      nameEs: 'Ajuste combustible corto plazo B1',
      nameEn: 'Short term fuel trim B1',
      unit: '%',
      category: PidCategory.fuel,
      dataBytes: 1,
      decode: (b) => (b[0] - 128) * 100 / 128,
    ),
    Obd2Pid(
      pid: '0107',
      nameEs: 'Ajuste combustible largo plazo B1',
      nameEn: 'Long term fuel trim B1',
      unit: '%',
      category: PidCategory.fuel,
      dataBytes: 1,
      decode: (b) => (b[0] - 128) * 100 / 128,
    ),
    Obd2Pid(
      pid: '010A',
      nameEs: 'Presión combustible',
      nameEn: 'Fuel pressure',
      unit: 'kPa',
      category: PidCategory.fuel,
      dataBytes: 1,
      decode: (b) => b[0] * 3,
    ),
    Obd2Pid(
      pid: '010B',
      nameEs: 'Presión colector admisión',
      nameEn: 'Intake manifold pressure',
      unit: 'kPa',
      category: PidCategory.air,
      dataBytes: 1,
      decode: (b) => b[0].toDouble(),
      normalMax: 100,
    ),
    Obd2Pid(
      pid: '010C',
      nameEs: 'RPM del motor',
      nameEn: 'Engine RPM',
      unit: 'rpm',
      category: PidCategory.engine,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]) / 4,
      normalMax: 5000,
      warningMax: 6500,
    ),
    Obd2Pid(
      pid: '010D',
      nameEs: 'Velocidad del vehículo',
      nameEn: 'Vehicle speed',
      unit: 'km/h',
      category: PidCategory.engine,
      dataBytes: 1,
      decode: (b) => b[0].toDouble(),
    ),
    Obd2Pid(
      pid: '010E',
      nameEs: 'Avance de encendido',
      nameEn: 'Timing advance',
      unit: '°',
      category: PidCategory.engine,
      dataBytes: 1,
      decode: (b) => (b[0] - 128) / 2,
    ),
    Obd2Pid(
      pid: '010F',
      nameEs: 'Temp. aire admisión',
      nameEn: 'Intake air temp',
      unit: '°C',
      category: PidCategory.air,
      dataBytes: 1,
      decode: (b) => b[0] - 40,
    ),
    Obd2Pid(
      pid: '0110',
      nameEs: 'Flujo de aire MAF',
      nameEn: 'MAF air flow rate',
      unit: 'g/s',
      category: PidCategory.air,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]) / 100,
    ),
    Obd2Pid(
      pid: '0111',
      nameEs: 'Posición mariposa',
      nameEn: 'Throttle position',
      unit: '%',
      category: PidCategory.air,
      dataBytes: 1,
      decode: (b) => b[0] * 100 / 255,
    ),
    Obd2Pid(
      pid: '011F',
      nameEs: 'Tiempo motor encendido',
      nameEn: 'Runtime since start',
      unit: 's',
      category: PidCategory.diagnostic,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]).toDouble(),
    ),
    Obd2Pid(
      pid: '0121',
      nameEs: 'Distancia con MIL encendido',
      nameEn: 'Distance with MIL on',
      unit: 'km',
      category: PidCategory.diagnostic,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]).toDouble(),
    ),
    Obd2Pid(
      pid: '012F',
      nameEs: 'Nivel de combustible',
      nameEn: 'Fuel level',
      unit: '%',
      category: PidCategory.fuel,
      dataBytes: 1,
      decode: (b) => b[0] * 100 / 255,
      normalMin: 10,
    ),
    Obd2Pid(
      pid: '0131',
      nameEs: 'Distancia desde borrado DTCs',
      nameEn: 'Distance since DTCs cleared',
      unit: 'km',
      category: PidCategory.diagnostic,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]).toDouble(),
    ),
    Obd2Pid(
      pid: '0133',
      nameEs: 'Presión barométrica',
      nameEn: 'Barometric pressure',
      unit: 'kPa',
      category: PidCategory.air,
      dataBytes: 1,
      decode: (b) => b[0].toDouble(),
    ),
    Obd2Pid(
      pid: '0142',
      nameEs: 'Voltaje módulo control',
      nameEn: 'Control module voltage',
      unit: 'V',
      category: PidCategory.electrical,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]) / 1000,
      normalMin: 12,
      normalMax: 15,
    ),
    Obd2Pid(
      pid: '0146',
      nameEs: 'Temp. aire ambiente',
      nameEn: 'Ambient air temp',
      unit: '°C',
      category: PidCategory.air,
      dataBytes: 1,
      decode: (b) => b[0] - 40,
    ),
    Obd2Pid(
      pid: '014D',
      nameEs: 'Tiempo con MIL encendido',
      nameEn: 'Time with MIL on',
      unit: 'min',
      category: PidCategory.diagnostic,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]).toDouble(),
    ),
    Obd2Pid(
      pid: '014E',
      nameEs: 'Tiempo desde borrado DTCs',
      nameEn: 'Time since DTCs cleared',
      unit: 'min',
      category: PidCategory.diagnostic,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]).toDouble(),
    ),
    Obd2Pid(
      pid: '015C',
      nameEs: 'Temp. aceite motor',
      nameEn: 'Engine oil temp',
      unit: '°C',
      category: PidCategory.engine,
      dataBytes: 1,
      decode: (b) => b[0] - 40,
      normalMax: 120,
      warningMax: 140,
    ),
    Obd2Pid(
      pid: '015E',
      nameEs: 'Tasa consumo combustible',
      nameEn: 'Fuel rate',
      unit: 'L/h',
      category: PidCategory.fuel,
      dataBytes: 2,
      decode: (b) => (b[0] * 256 + b[1]) / 20,
    ),
  ];

  static Obd2Pid? byPid(String pid) {
    final upper = pid.toUpperCase();
    for (final p in all) {
      if (p.pid.toUpperCase() == upper) return p;
    }
    return null;
  }

  static List<Obd2Pid> byCategory(PidCategory category) =>
      all.where((p) => p.category == category).toList();
}
